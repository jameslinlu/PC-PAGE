(function(e,g,b){var i=g.isDefined,c=g.isUndefined,j=g.isNumber,k=g.isObject,d=g.isArray,f=g.extend,a=g.toJson;var h=g.module("LocalStorageModule",[]);h.provider("localStorageService",function(){this.prefix="";this.storageType="localStorage";this.cookie={expiry:30,path:"/"};this.notify={setItem:true,removeItem:false};this.setPrefix=function(l){this.prefix=l;return this};this.setStorageType=function(l){this.storageType=l;return this};this.setStorageCookie=function(m,l){this.cookie.expiry=m;this.cookie.path=l;return this};this.setStorageCookieDomain=function(l){this.cookie.domain=l;return this};this.setNotify=function(l,m){this.notify={setItem:l,removeItem:m};return this};this.$get=["$rootScope","$window","$document","$parse",function(s,A,H,p){var B=this;var D=B.prefix;var G=B.cookie;var y=B.notify;var F=B.storageType;var C;if(!H){H=document}else{if(H[0]){H=H[0]}}if(D.substr(-1)!=="."){D=!!D?D+".":""}var t=function(K){return D+K};var z=(function(){try{var K=(F in A&&A[F]!==null);var L=t("__"+Math.round(Math.random()*10000000));if(K){C=A[F];C.setItem(L,"");C.removeItem(L)}return K}catch(M){F="cookie";s.$broadcast("LocalStorageModule.notification.error",M.message);return false}}());var x=function(K,L){if(c(L)){L=null}else{L=a(L)}if(!z||B.storageType==="cookie"){if(!z){s.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED")}if(y.setItem){s.$broadcast("LocalStorageModule.notification.setitem",{key:K,newvalue:L,storageType:"cookie"})}return v(K,L)}try{if(C){C.setItem(t(K),L)}if(y.setItem){s.$broadcast("LocalStorageModule.notification.setitem",{key:K,newvalue:L,storageType:B.storageType})}}catch(M){s.$broadcast("LocalStorageModule.notification.error",M.message);return v(K,L)}return true};var w=function(K){if(!z||B.storageType==="cookie"){if(!z){s.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED")}return u(K)}var L=C?C.getItem(t(K)):null;if(!L||L==="null"){return null}try{return JSON.parse(L)}catch(M){return L}};var o=function(){var L,K;for(L=0;L<arguments.length;L++){K=arguments[L];if(!z||B.storageType==="cookie"){if(!z){s.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED")}if(y.removeItem){s.$broadcast("LocalStorageModule.notification.removeitem",{key:K,storageType:"cookie"})}n(K)}else{try{C.removeItem(t(K));if(y.removeItem){s.$broadcast("LocalStorageModule.notification.removeitem",{key:K,storageType:B.storageType})}}catch(M){s.$broadcast("LocalStorageModule.notification.error",M.message);n(K)}}}};var m=function(){if(!z){s.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED");return false}var K=D.length;var M=[];for(var L in C){if(L.substr(0,K)===D){try{M.push(L.substr(K))}catch(N){s.$broadcast("LocalStorageModule.notification.error",N.Description);return[]}}}return M};var r=function(K){var P=!!D?new RegExp("^"+D):new RegExp();var N=!!K?new RegExp(K):new RegExp();if(!z||B.storageType==="cookie"){if(!z){s.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED")}return J()}var L=D.length;for(var M in C){if(P.test(M)&&N.test(M.substr(L))){try{o(M.substr(L))}catch(O){s.$broadcast("LocalStorageModule.notification.error",O.message);return J()}}}return true};var E=(function(){try{return A.navigator.cookieEnabled||("cookie" in H&&(H.cookie.length>0||(H.cookie="test").indexOf.call(H.cookie,"test")>-1))}catch(K){s.$broadcast("LocalStorageModule.notification.error",K.message);return false}}());var v=function(P,Q,O){if(c(Q)){return false}else{if(d(Q)||k(Q)){Q=a(Q)}}if(!E){s.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED");return false}try{var N="",L=new Date(),K="";if(Q===null){L.setTime(L.getTime()+(-1*24*60*60*1000));N="; expires="+L.toGMTString();Q=""}else{if(j(O)&&O!==0){L.setTime(L.getTime()+(O*24*60*60*1000));N="; expires="+L.toGMTString()}else{if(g.isDate(O)&&O!==0){N="; expires="+O.toGMTString()}else{if(G.expiry!==0){L.setTime(L.getTime()+(G.expiry*24*60*60*1000));N="; expires="+L.toGMTString()}}}}if(!!P){var M="; path="+G.path;if(G.domain){K="; domain="+G.domain}H.cookie=t(P)+"="+encodeURIComponent(Q)+N+M+K}}catch(R){s.$broadcast("LocalStorageModule.notification.error",R.message);return false}return true};var u=function(M){if(!E){s.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED");return false}var N=H.cookie&&H.cookie.split(";")||[];for(var L=0;L<N.length;L++){var K=N[L];while(K.charAt(0)===" "){K=K.substring(1,K.length)}if(K.indexOf(t(M)+"=")===0){var O=decodeURIComponent(K.substring(D.length+M.length+1,K.length));try{return JSON.parse(O)}catch(P){return O}}}return null};var n=function(K){v(K,null)};var J=function(){var L=null,O=null;var K=D.length;var P=H.cookie.split(";");for(var N=0;N<P.length;N++){L=P[N];while(L.charAt(0)===" "){L=L.substring(1,L.length)}var M=L.substring(K,L.indexOf("="));n(M)}};var l=function(){return F};var q=function(L,K,O,M){M=M||K;var N=w(M);if(N===null&&i(O)){N=O}else{if(k(N)&&k(O)){N=f(O,N)}}p(K).assign(L,N);return L.$watch(K,function(P){x(M,P)},k(L[K]))};var I=function(){var L=0;var M=A[F];for(var K=0;K<M.length;K++){if(M.key(K).indexOf(D)===0){L++}}return L};return{isSupported:z,getStorageType:l,set:x,add:x,get:w,keys:m,remove:o,clearAll:r,bind:q,deriveKey:t,length:I,cookie:{isSupported:E,set:v,add:v,get:u,remove:n,clearAll:J}}}]})})(window,window.angular);